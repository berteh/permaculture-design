#:kivy 2.1.0

<SelectableLabel>:
	font_size: '28dp'
  	# Draw a background to indicate selection
	canvas.before:
		Color:
			rgba: (66/255, 139/255, 70/255, 1) if self.selected else (199/255, 177/255, 152/255, 1)
		Rectangle:
			pos: self.pos
			size: self.size
<RV>:
	viewclass: 'SelectableLabel'
	SelectableRecycleBoxLayout:
		default_size: None, dp(56)
		default_size_hint: 1, None
		size_hint_y: None
		height: self.minimum_height
		orientation: 'vertical'
		multiselect: False
		touch_multiselect: False

<SearchTextField>:
	font_size: '32dp'
	hint_text: 'Plant Search'
	hint_text_size: '36dp'
	mode: 'round'
	icon_left: 'magnify'
	background_color: app.theme_cls.bg_normal

<NameLabel>:
	text: 'Plant Name'
	font_size: '48dp'
	pos_hint: {"center_x": .5, "center_y": .5}
	size_hint: (.8, .2)

<TabbedPanelItem>:
	BoxLayout:
		canvas:
			Color:
				rgba: (199/255, 177/255, 152/255, 1) # Helps see where the panel is
			Rectangle:
				pos: self.pos
				size: self.size

<LeftPanel>:
	id: left_panel
	do_default_tab: False
	tab_pos: 'top_mid'
	tab_height: 50
	size_hint: (0.3, 1)
	canvas.before:
		Color:
			rgba: (199/255, 177/255, 152/255, 1) # Helps see where the panel is
		Rectangle:
			pos: self.pos
			size: self.size

	TabbedPanelItem:
		id: filters_tab
		text: 'Filters'

		MDBoxLayout:
			orientation: 'vertical'
			padding: '42dp'
			spacing: '30dp'
			md_bg_color: (199/255, 177/255, 152/255, 1)

			MDBoxLayout:
				id: hardiness_zones_container
				orientation: 'vertical'
				spacing: '20dp'
				Label:
					text: 'Hardiness Zone'
					font_size: '28dp'

				MDBoxLayout:
					MDSlider:
						id: hardiness_zone_slider
						min: 2
						max: 13
						step: 1
						hint: False
					Label:
						size_hint: (.2, 1)
						text: str(hardiness_zone_slider.value)
						font_size: '24dp'

			MDBoxLayout:
				id: form_box
				orientation: 'vertical'
				Label:
					text: 'Plant Form'
					font_size: '28dp'

				MDBoxLayout:
					id: form_chips
					orientation: 'horizontal'
					padding: '10dp'
					spacing: '5dp'
					MyChip:
						id: herb_chip
						text: "Herb"
					MyChip:
						id: shrub_chip
						text: "Shrub"
					MyChip:
						id: tree_chip
						text: "Tree"
					MyChip:
						id: bamboo_chip
						text: 'Other'

			MDBoxLayout:
				id: pollinator_box
				orientation: 'vertical'
				Label:
					text: 'Pollinators'
					font_size: '28dp'
				MDBoxLayout:
					id: pollinator_chips
					orientation: 'vertical'
					spacing: '5dp'
					MDBoxLayout:
						orientation: 'horizontal'
						padding: '10dp'
						spacing: '5dp'
						MyChip:
							id: wind_chip
							text: 'Wind'
						MyChip:
							id: insects_chip
							text: 'Insects'
						MyChip:
							id: bees_chip
							text: 'Bees'
					MDBoxLayout:
						orientation: 'horizontal'
						padding: '10dp'
						spacing: '5dp'
						MyChip:
							id: butterflies_chip
							text: 'Butterflies'
						MyChip:
							id: flies_chip
							text: 'Flies'
						MyChip:
							id: bats_chip
							text: 'Bats'
			MDBoxLayout:
				Label:
					text: 'Flower Month: '
					font_size: '24sp'
				MDDropDownItem:
					id: flower_month_dropitem
					size_hint: None, None
					pos_hint: {'center_x': .5, 'center_y': .5}
					text: 'Any'
					font_size: '20dp'
					# on_release: something()
				Label:
					text: 'Nectary Value: '
					font_size: '24sp'
				MDDropDownItem:
					id: flower_month_dropitem
					background_color: 'white'
					size_hint: None, None
					pos_hint: {'center_x': .5, 'center_y': .5}
					text: 'Any'
					font_size: '20dp'
					# on_release: something()


	TabbedPanelItem:
		id: design_view_tab
		text: 'Design View'
		BoxLayout:
			orientation: 'vertical'
			padding: '42dp'
			spacing: '30dp'

			SearchTextField:
				id: search_field
				hint_text: 'Search for a plant'
				font_size: dp(48)
				size_hint_y: None
				height: dp(80)
				multiline: False
				on_text_validate: root.search(self)
			TreeButton:
				id: tree_button
				background_normal: ''
				background_color: 0, 0, 0, 0
				pos_hint: {"center_x": .5, "center_y": .5}
				text: 'Drag and drop on canvas'
				size_hint: None, 2
				size: self.height, self.height
				canvas.before:
					Color:
						rgba: 66/255, 139/255, 70/255, 1
					Ellipse: # Outer circle
						pos: self.center_x - self.height/2, self.center_y - self.height/2
						size: min(self.width, self.height), min(self.width, self.height)
					Color:
						rgba: 60/255, 42/255, 33/255, 1
					Ellipse: # Trunk (center circle)
						pos: self.center_x - self.height/20, self.center_y - self.height/20
						size: self.height/10, self.height/10
			RV:
				id: rv
			ScrollableLabel:
				Label:
					id: plant_attrs
					text: ''
					font_size: '20dp'
					text_size: self.width, None
					size_hint_y: None
					height: '350dp'
	TabbedPanelItem:
		text: 'Design Sheets'
	TabbedPanelItem:
		text: 'My Designs'
	TabbedPanelItem:
		text: 'Settings'
		Button:
			text: 'Print Children'
			on_release: root.print_ids()

<CenterDisplay>: # Here I have the initialize design panel, need to create the grid upon 'submit'
# I want to bind this display to the tabs in the LeftPanel, depending on which tab is selected
	id: design_panel
	size_hint: (.7,1)
	BoxLayout:
		orientation: 'vertical'
		spacing: '24dp'
		padding: '24dp'
		size_hint: .3, None
		pos_hint: {"center_x": .5, "center_y": .5}
		MDLabel:
			text: 'Initialize Design'
			font_size: '36dp'
		MDTextField:
			id: plot_length
			input_filter: 'int'
			font_size: '32dp'
			hint_text: 'Length'
			hint_text_size: '36dp'
			mode: 'round'
			input_type: 'number'
		MDTextField:
			id: plot_width
			input_filter: 'int'
			font_size: '32dp'
			hint_text: 'Width'
			hint_text_size: '36dp'
			mode: 'round'
			background_color: app.theme_cls.bg_normal
		Label:
			id: total_area
			font_size: '32dp'
			hint_text: 0
			size_hint: None, None
			color: 0, 0, 0, 1    # Sorry for the long line below
			text: str(round(int(plot_length.text) * int(plot_width.text) / (10000 if unit_selection.units=='meters' else 43560), 2)) if plot_length.text and plot_width.text else '0'  + ' ' + unit_selection.units + '\u00b2'
		MDFillRoundFlatButton:
			id: upload_background
			text: 'Add aerial background photo'
			font_size: '24dp'
		UnitSelection:
			id: unit_selection
			size_hint: None, None

<Check@MDCheckbox>:
	group: 'group'
	size_hint: None, None
	size: dp(48), dp(48)
	allow_no_selection: False
	radio_icon_down: 'radiobox-marked'

<MetricCheck@MDCheckbox>:
	group: 'group'
	size_hint: None, None
	size: dp(48), dp(48)
	allow_no_selection: False
	radio_icon_down: 'radiobox-marked'

<UnitSelection>:
	cols: 2
	size_hint: .6, None
	units: self.units_selected(self, metric_check.active)
	MetricCheck:
		id: metric_check
		active: True
		group: 'units'
		pos_hint: {'center_x': .5, 'center_y': .5}
		on_active: root.units_selected(self, self.active)
	Label:
		text: 'Meters / Hectares'
		font_size: '18dp'
		color: 0, 0, 0, 1
	Check: # Feet / Acres checkbox but only MetricCheck needs to be connected
		group: 'units'
		pos_hint: {'center_x': .5, 'center_y': .5}
	Label:
		text: 'Feet / Acres'
		font_size: '18dp'
		color: 0, 0, 0, 1
	MDFillRoundFlatButton:
		id: submit_button
		text: 'Submit'
		font_size: '24dp'
		on_release: print(root.units_selected(root, metric_check.active))

<Main>:
	LeftPanel:
	CenterDisplay:
