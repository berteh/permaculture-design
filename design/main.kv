#:kivy 2.1.0

<SelectableLabel>:
	font_size: '28dp'
  	# Draw a background to indicate selection
	canvas.before:
		Color:
			rgba: (66/255, 139/255, 70/255, 1) if self.selected else (199/255, 177/255, 152/255, 1)
		Rectangle:
			pos: self.pos
			size: self.size
<RV>:
	viewclass: 'SelectableLabel'
	SelectableRecycleBoxLayout:
		default_size: None, dp(56)
		default_size_hint: 1, None
		size_hint_y: None
		height: self.minimum_height
		orientation: 'vertical'
		multiselect: False
		touch_multiselect: False

<SearchTextField>:
	font_size: '32dp'
	hint_text: 'Plant Search'
	hint_text_size: '36dp'
	mode: 'round'
	icon_left: 'magnify'
	background_color: app.theme_cls.bg_normal

<NameLabel>:
	text: 'Plant Name'
	font_size: '48dp'
	pos_hint: {"center_x": .5, "center_y": .5}
	size_hint: (.8, .2)

<Main>:
	LeftPanel:
		id: left_panel
		do_default_tab: False
		tab_pos: 'top_mid'
		tab_height: 50
		size_hint: (0.25, 1)
		TabbedPanelItem:
			text: 'Current Plant'
			BoxLayout:
				orientation: 'vertical'
				padding: '42dp'
				spacing: '30dp'
				canvas:
					Color:
						rgba: (199/255, 177/255, 152/255, 1) # Helps see where the panel is
					Rectangle:
						pos: self.pos
						size: self.size

				SearchTextField:
					id: search_field
					hint_text: 'Search for a plant'
					font_size: dp(48)
					size_hint_y: None
					height: dp(80)
					multiline: False
					on_text_validate: root.search(self)

				RV:
					id: rv

				ScrollableLabel:
					Label:
						id: plant_attrs
						text: ''
						font_size: '20dp'
						text_size: self.width, None
						size_hint_y: None
						height: '350dp'


				TreeButton:
					id: tree_button
					background_normal: ''
					background_color: 0, 0, 0, 0
					pos_hint: {"center_x": .5, "center_y": .5}
					size_hint: None, 2
					size: self.height, self.height
					canvas.after:
						Color:
							rgba: 66/255, 139/255, 70/255, 1
						Ellipse: # Outer circle
							pos: self.center_x - self.height/2, self.center_y - self.height/2
							size: min(self.width, self.height), min(self.width, self.height)
						Color:
							rgba: 60/255, 42/255, 33/255, 1
						Ellipse: # Trunk (center circle)
							pos: self.center_x - self.height/20, self.center_y - self.height/20
							size: self.height/10, self.height/10


		TabbedPanelItem:
			text: 'Database'
			BoxLayout:
				orientation: 'vertical'
				Label:
					text: 'Plant Database'
		TabbedPanelItem:
			text: 'My Designs'


	DesignPanel:
		id: design_panel
		size_hint: (.75,1)
		BoxLayout:
			orientation: 'vertical'
			spacing: '24dp'
			padding: '24dp'
			size_hint: .2, None
			pos_hint: {"center_x": .5, "center_y": .5}
			MDTextField:
				id: plot_length
				input_filter: 'int'
				font_size: '32dp'
				hint_text: 'Length'
				hint_text_size: '36dp'
				mode: 'round'
				input_type: 'number'
			MDTextField:
				id: plot_width
				input_filter: 'int'
				font_size: '32dp'
				hint_text: 'Width'
				hint_text_size: '36dp'
				mode: 'round'
				background_color: app.theme_cls.bg_normal
			UnitSelection:
				id: unit_selection
				size_hint: None, None
			Label:
				id: total_area
				font_size: '32dp'
				hint_text: 0
				size_hint: None, None
				color: 0, 0, 0, 1
				text: str(round(int(plot_length.text) * int(plot_width.text) / (10000 if unit_selection.units=='meters' else 43560), 2)) if plot_length.text and plot_width.text else '0'

<Check@MDCheckbox>:
	group: 'group'
	size_hint: None, None
	size: dp(48), dp(48)
	allow_no_selection: False
	radio_icon_down: 'radiobox-marked'

<MetricCheck@MDCheckbox>:
	group: 'group'
	size_hint: None, None
	size: dp(48), dp(48)
	allow_no_selection: False
	radio_icon_down: 'radiobox-marked'

<UnitSelection>:
	cols: 2
	size_hint: .6, None
	units: self.units_selected(self, metric_check.active)
	MetricCheck:
		id: metric_check
		active: True
		group: 'units'
		pos_hint: {'center_x': .5, 'center_y': .5}
		on_active: root.units_selected(self, self.active)
	Label:
		text: 'Meters / Hectares'
		font_size: '18dp'
		color: 0, 0, 0, 1
	Check: # Feet / Acres checkbox but only MetricCheck needs to be connected
		group: 'units'
		pos_hint: {'center_x': .5, 'center_y': .5}
	Label:
		text: 'Feet / Acres'
		font_size: '18dp'
		color: 0, 0, 0, 1

#### BIND BUTTON TO total_area LABEL in DesignPanel
	# MDFillRoundFlatButton:
	# 	id: calculate_button
	# 	text: 'Calculate Area'
	# 	font_size: '24dp'
	# 	on_release: total_area.show_text()

	MDFillRoundFlatButton:
		id: submit_button
		text: 'Submit'
		font_size: '24dp'
		on_release: print(root.units_selected(root, metric_check.active))
